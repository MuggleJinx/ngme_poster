<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">


<!--
Font-awesome icons ie github or twitter
-->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/brands.css" integrity="sha384-n9+6/aSqa9lBidZMRCQHTHKJscPq6NW4pCQBiMmHdUCvPN8ZOg2zJJTkC7WIezWv" crossorigin="anonymous">

<!--
Google fonts api stuff
-->



<title>Ngme2 - A new Flexible R Package for Latent non-Gaussian Model</title>






<style>
@page {
size: 55.0in 28.5in;
margin: 0;
padding: 0;
}
body {
margin: 0;
font-size: 45px;
width: 55.0in;
height: 28.5in;
padding: 0;
text-align: justify;
font-family: Palatino;
}
.poster_wrap {
width: 55.0in;
height: 28.5in;
padding: 0cm;
}
.title_container {
width: calc(100% - 0.5cm - 0.5cm);
height: calc(15% - 0.5cm - 0.5cm);
overflow: hidden;
background-color: #EDE3FF;
border: 0.5cm solid #AF9FC9;
}
.logo_left {
float: left;
width: 10%;
height: 100%;
background-color: #EDE3FF;
display: flex;
justify-content: center;
transform: scale(0.8,0.8);
}
.logo_right {
float: right;
width: 10%;
height: 100%;
background-color: #EDE3FF;
display: flex;
justify-content: center;
transform: translateY(-5pt);
}
.poster_title {
text-align: center;
position: relative;
float: left;
width: 80%;
height: 100%;
color: black;
top: 50%;
transform: translateY(-40%);
-webkit-transform: translateY(-40%);
}
#title {
font-family: Palatino;
}
/* unvisited link */
a:link {
color: #008080;
text-decoration: none;
}
.mybreak {
  break-before: column;
}
/* visited link */
a:visited {
color: #008080;
text-decoration: none;
}

/* mouse over link */
a:hover {
color: #008080;
text-decoration: none;
}

/* selected link */
a:active {
color: #008080;
text-decoration: none;
}
.poster_body {
-webkit-column-count: 4; /* Chrome, Safari, Opera */
-moz-column-count: 4; /* Firefox */
column-count: 4;
-webkit-column-fill: auto;
-moz-column-fill: auto;
column-fill: auto;
-webkit-column-rule-width: 1mm;
-moz-column-rule-width: 1mm;
column-rule-width: 1mm;
-webkit-column-rule-style: dashed;
-moz-column-rule-style: dashed;
column-rule-style: dashed;
-webkit-column-rule-color: #EDE3FF;
-moz-column-rule-color: #EDE3FF;
column-rule-color: #EDE3FF;
column-gap: 1em;
padding-left: 0.5em;
padding-right: 0.5em;
height: 100%;
color: #000000
background-color: #ffffff;
}
.poster_title h1 {
font-size: 75pt;
margin: 0;
border: 0;
font-weight: normal;
}
.poster_body_wrap{
width: 55.0in;
height: calc(100% - 17%);
padding-top: calc(28.5in * 0.01);
padding-bottom: calc(28.5in * 0.01);
background-color: #ffffff;
}
.poster_title h3 {
color: black;
font-size: 50pt;
margin: 0;
border: 0;
font-weight: normal;
}
.poster_title h3 > sup {
  font-size: 35pt;
  margin-left: 0.02em;
}
.poster_title h5 {
color: black;
font-size: 35pt;
margin: 0;
border: 0;
font-weight: normal;
}
img {
margin-top: 0;
margin-bottom: 0;
}
.section {
  padding: 0.2em;
}
.poster_body h1 {
text-align: center;
color: #000000;
font-size: 65pt;
border: 2mm solid #EDE3FF;
background-color: #EDE3FF;
border-radius: 4mm 0mm;
margin-top: 2mm;
margin-bottom: 2mm;
font-weight: normal;
}
.poster_body h2 {
color: #000000;
font-size: 40pt;
padding-left: 4mm;
font-weight: normal;
}
.span {
width: 200%;
}
/* center align leaflet map,
from https://stackoverflow.com/questions/52112119/center-leaflet-in-a-rmarkdown-document */
.html-widget {
margin: auto;
position: sticky;
margin-top: 2cm;
margin-bottom: 2cm;
}
.leaflet.html-widget.html-widget-static-bound.leaflet-container.leaflet-touch.leaflet-fade-anim.leaflet-grab.leaflet-touch-drag.leaflet-touch-zoom {
position: sticky;
width: 100%;
}
pre.sourceCode.r, pre.sourceCode.python {
background-color: #ffffff20;
border: solid #EDE3FF 1mm;
border-radius: 0.5em;
padding: 4mm;
margin: auto;
margin-top: 1em;
margin-bottom: 1em;
/* align-items: center; */
}
div.sourceCode {
background-color: transparent;
width: 85%;
margin-left: auto;
margin-right: auto;
}
code.sourceCode.r, code.sourceCode.python {
background-color: transparent;
font-size: 20pt;
border-radius: 2mm;
}
code {
font-size: 25pt;
font-family: monospace;
background-color: #EDE3FF24;
color: #EDE3FF;
padding: 1.2mm;
line-height: 1;
border-radius: 2mm;
}
.caption {
font-size: 20pt;
}
.table caption {
font-size: 20pt;
padding-bottom: 3mm;

}
code {
font-size: 1em;
font-family: monospace;
background-color: #EDE3FF24;
color: #666;
padding: 1.2mm;
border-radius: 2mm;
}
.poster_title code {
font-size: 1em;
}
table {
font-size: 40px;
margin: auto;
border-top: 3px solid #666;
border-bottom: 3px solid #666;
}
table thead th {
border-bottom: 3px solid #ddd;
}
td {
padding: 8px;
}
th {
padding: 15px;
}
caption {
margin-bottom: 10px;
}
.poster_body p {
margin-right: 4mm;
margin-left: 4mm;
margin-top: 6mm;
margin-bottom: 10mm;
color: #000000
}
.poster_body ol {
margin-right: 4mm;
margin-left: 4mm;
}
#ul {
margin-right: 4mm;
margin-left: 4mm;
}
.references p {
font-size: 20pt;
}
.orcid img {
  width: 1em;
}
</style>
</head>
<body>


<div class="poster_wrap">
<div class="title_container">
<!-- Left Logo  -->
<div class="logo_left">
<img src=https://raw.githubusercontent.com/vpnsctl/posterdown/master/images/stat_logo.png style="width: 80%">
</div>
<!-- Poster Title -->
<div class= "poster_title">
<h1 id="title">Ngme2 - A new Flexible R Package for Latent non-Gaussian Model</h1>
<h3 id="author">Xiaotian Jin<sup>1</sup></h3>
<h5 id="affiliation"><sup>1</sup> Department of Statistics, KAUST</h5>
</div>
<!-- Right Logo  -->
<div class="logo_right">
<img src=https://raw.githubusercontent.com/vpnsctl/posterdown/master/images/group_logo2.png style="width: 80%">
</div>
</div>

<div class='poster_body_wrap'>
<div class='poster_body'>
<div id="introduction" class="section level1">
<h1>1 Introduction</h1>
<p><code>ngme2</code> is the updated version of <code>ngme</code> (<a href="https://github.com/davidbolin/ngme" class="uri">https://github.com/davidbolin/ngme</a>), a package for estimating latent non-Gaussian models.
It follows a <strong>3-layer structure</strong> in design (the general block model, latent process models, and noises) for specifying the whole statistical model.
The latent process defines different operator structure, and the block model collects them with the fixed effects and measurement noise.</p>
<div id="features" class="section level3">
<h3>1.1 Features</h3>
<ol style="list-style-type: decimal">
<li>Support spatial models like Matern model with non-Gaussian noise.</li>
<li>Support replicates at same locations.</li>
<li>Support multiple parallel chains estimation.</li>
<li>Support prediction at unknown locations.</li>
<li>Comparing to the previous version, it allows for nonstaionarity for skewness of the noise, and also measurement noise.</li>
</ol>
</div>
</div>
<div id="modeling-framework" class="section level1">
<h1>2 Modeling Framework</h1>
<p>The package <code>ngme2</code> provides methods for mixed effect models in the following form:</p>
<p><span class="math display">\[
\begin{aligned}
Y_{i} = {\bf X}^{\top} {\bf \beta} + \sum_j {\bf A}_j W_j({\bf t}) + \epsilon_{i}.
\end{aligned}
\]</span></p>
<p>Here,</p>
<ul>
<li><span class="math inline">\(i = 1, \ldots, m\)</span> (subject index), <span class="math inline">\(j = 1, \ldots, n_i\)</span> (replicate index),</li>
<li><span class="math inline">\(Y_i\)</span> is the response variable for at index <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\({\bf X}\)</span> is the matrix of fixed effects explanatory variables,</li>
<li><span class="math inline">\({\bf \beta}\)</span> is the matrix of fixed effects coefficients,</li>
<li><span class="math inline">\({\bf A}_j\)</span> is the observation matrix for each process,</li>
<li><span class="math inline">\(W_j(t_j)\)</span> is specified as a stochastic process,</li>
<li><span class="math inline">\(\epsilon_{i}\)</span> is measurement error.</li>
</ul>
<p>Here, the process <span class="math inline">\(W\)</span> follows <span class="math inline">\({\bf K} W = z\)</span>,
where <span class="math inline">\(z\)</span> is either Gaussian or non-Gaussian noise.
<span class="math inline">\({\bf K}\)</span> is the operator matrix.</p>
<div id="non-gaussian-model" class="section level3">
<h3>2.1 Non-Gaussian Model</h3>
<p>Here we assume the non-Gaussian process is a type-G Lévy process,
whose increments can be represented as location-scale mixtures:
<span class="math display">\[\gamma + \mu V + \sigma \sqrt{V}Z,\]</span>
where <span class="math inline">\(\gamma, \mu, \sigma\)</span> are parameters, <span class="math inline">\(Z\sim N(0,1)\)</span> and is independent of <span class="math inline">\(V\)</span>, and <span class="math inline">\(V\)</span> is a positive infinitely divisible random variable.
It results in the following form, where <span class="math inline">\(K\)</span> is the operator part:</p>
<p><span class="math display">\[
KW|V \sim N(\gamma + \mu V, \sigma^2 \, diag(V)),
\]</span>
also, notice that <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> can be non-stationary.</p>
<p>In <code>ngme2</code>, we focus mainly on the normal inverse Gaussian (NIG) model.
In this case, <span class="math inline">\(V\)</span> follows Inverse Gaussian distribution with parameter <span class="math inline">\(\nu\)</span> (IG(<span class="math inline">\(\nu\)</span>, <span class="math inline">\(\nu\)</span>)).</p>
</div>
</div>
<div id="ngme-model-structure---3-layer-structure" class="section level1">
<h1>3 Ngme Model Structure - 3-Layer structure</h1>
<div id="ngme_noise---first-building-block" class="section level3">
<h3>3.1 ngme_noise - first building block</h3>
<p>The noise is the most fundamental structure in <code>ngme2</code>. For now we support 2 noises.
One is normal noise, the other is the NIG noise.</p>
<p>The R class <code>ngme_noise</code> has the following interface:</p>
<pre><code>noise_normal(sd = 1)
noise_nig(mu = 1, sigma = 2, nu = 1)
noise_nig(B_mu, theta_mu = c(1, 2),
  B_sigma, sigma = c(1,2), nu = 1)</code></pre>
<p>They are stationary and non-stationary NIG noise,
where <span class="math inline">\(\mu = \bf B_{\mu} \bf \theta_{\mu}\)</span>, and <span class="math inline">\(\sigma = \exp(\bf B_{\sigma} \bf \theta_{\sigma})\)</span>.</p>
</div>
<div id="ngme_model---process-equiped-with-some-noise" class="section level3">
<h3>3.2 ngme_model - process equiped with some noise</h3>
<p>The middle layer is the stochastic process, in R interface, it is represented as a <code>f</code> function.
The process can be specified by different noise structure.</p>
<p>Some examples of using <code>f</code> function to specify <code>ngme_model</code>:</p>
<pre><code>f(index = 1:10, model = &quot;ar1&quot;,
  noise = noise_nig(), theta_K = 0.5)</code></pre>
</div>
<div id="ngme_block---the-most-upper-model-collects-different" class="section level3">
<h3>3.3 ngme_block - the most upper model collects different</h3>
<p>The <code>ngme_block</code> is the highest level structure with 3 components:</p>
<ol style="list-style-type: decimal">
<li>Fixed effects (intercept and x1)</li>
<li>Measurement noise (normal noise)</li>
<li>Latent models (a list of ngme_models)</li>
</ol>
</div>
</div>
<div id="application---estimation-of-paraná-data" class="section level1">
<h1>4 Application - Estimation of Paraná data</h1>
<p>The rainfall data from Paraná (Brazil) is collected by the National Water Agency in Brazil (Agencia Nacional de Águas, ANA, in Portuguese).
ANA collects data from many locations over Brazil, and all these data are freely available from the ANA website (<a href="http://www3.ana.gov.br/portal/ANA" class="uri">http://www3.ana.gov.br/portal/ANA</a>).</p>
<p>We will briefly illustrate the command we use, and the result of the estimation.</p>
<p>R command for fitting the model using <code>ngme2</code></p>
<pre><code>ngme(
  formula = Y_mean ~ 1 +
    f(inla.group(seaDist), model = &quot;rw1&quot;,
      noise=noise_normal()) +
    f(index = mesh.index$field, model =
      model_matern(A = A, mesh = prmesh,
      noise = noise_nig())),
  data = data,
  family = noise_nig(),
  control = ngme_control(
    iterations = 20,
    stop_points = 100,
    n_parallel_chain = 8
  )
)</code></pre>
<p>Result of the fitting:</p>
<p><img src="poster_files/figure-html/unnamed-chunk-2-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>

</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
var script = document.createElement("script");
script.type = "text/javascript";
var src = "true";
if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
if (location.protocol !== "file:" && /^https?:/.test(src))
src = src.replace(/^https?:/, '');
script.src = src;
document.getElementsByTagName("head")[0].appendChild(script);
})();
</script>


</body>
</html>
